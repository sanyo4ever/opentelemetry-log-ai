clickhouse:
  host: clickhouse
  port: 9000
  database: signoz_logs
  table: logs_v2
  poll_interval: 5
  batch_size: 20000
  # Optional server-side filtering (recommended for high-volume ClickHouse tables)
  # service_name_allowlist: ["windows-security", "windows-powershell"]
  # body_contains: ["EventID", "mimikatz", "lsass.exe"]
  # additional_where: "resources_string['host.name'] = 'my-host'"
  # Initial start behavior (only applies when no checkpoint exists)
  # Options: "now" (default) - start from current time, "beginning" - process all historical logs
  initial_start_mode: "now"
  # Optional: Authentication (uncomment if needed)
  # user: default
  # password: your_password

sigma:
  rules_path: ./config/sigma_rules/rules
  # Optional: load additional Sigma rule packs (SigmaHQ repo layout).
  # rules_paths:
  #   - ./config/sigma_rules/rules
  #   - ./config/sigma_rules/rules-emerging-threats
  #   - ./config/sigma_rules/rules-threat-hunting
  #   - ./config/sigma_rules/rules-compliance
  # Optional: limit rules by category/product to improve performance.
  # enabled_products: [windows, linux]
  # enabled_categories: [process_creation, network_connection, file_event]
  severity_filter: [high, critical]

  # Sigma Rules Auto-Updater settings
  updater:
    enabled: true                    # Enable background update checker
    check_interval_hours: 24         # How often to check for updates (default: 24)
    auto_update: true                # Automatically pull updates when available
    notify_on_updates: true          # Log when updates are available

alerting:
  keep_webhook_url: https://api.keep-zpz9.consultic.tech/alerts/event
  keep_api_key: "${KEEP_API_KEY}"  # Your Keep API key (X-API-KEY header)
  deduplication_window: 300  # seconds
  max_alerts_per_minute: 100
  max_retries: 3  # webhook retry attempts
  retry_delay: 1  # initial retry delay in seconds (exponential backoff)
  use_redis: false  # set to true for distributed deduplication

# Optional: Redis configuration for distributed deduplication
redis:
  host: localhost
  port: 6379
  db: 0
  # password: your_redis_password

# Checkpoint configuration
checkpoint:
  file: data/checkpoint.json

logging:
  level: INFO
  file: logs/security-analyzer.log

# Stats reporting interval (seconds)
stats_interval: 60
